FROM n8nio/runners:latest
USER root
RUN uv pip install --python /opt/runners/task-runner-python/.venv/bin/python \
    PyMuPDF pymupdf4llm pymupdf-layout
RUN sed -i 's/"N8N_RUNNERS_STDLIB_ALLOW": ""/"N8N_RUNNERS_STDLIB_ALLOW": "*"/' /etc/n8n-task-runners.json && \
    sed -i 's/"N8N_RUNNERS_EXTERNAL_ALLOW": ""/"N8N_RUNNERS_EXTERNAL_ALLOW": "*"/' /etc/n8n-task-runners.json
USER runner